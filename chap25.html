
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Chapter 25 &#8212; Modeling and Simulation in Python</title>
    
  <link rel="stylesheet" href="_static/css/index.f658d18f9b420779cfdf24aa0a7e2d77.css">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/sphinx-book-theme.40e2e510f6b7d1648584402491bb10fe.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="_static/js/index.d3f166471bb80abb5163.js">

    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.d31b09fe5c1d09cb49b26a786de4a05d.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Chapter 26" href="chap26.html" />
    <link rel="prev" title="Chapter 24" href="chap24.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="index.html">
  
  
  <h1 class="site-logo" id="site-title">Modeling and Simulation in Python</h1>
  
</a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="index.html">
   Modeling and Simulation in Python
  </a>
 </li>
</ul>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="preface.html">
   Preface
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chap01.html">
   Chapter 1
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chap02.html">
   Chapter 2
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chap03.html">
   Chapter 3
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chap04.html">
   Chapter 4
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chap05.html">
   Chapter 5
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chap06.html">
   Chapter 6
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chap07.html">
   Chapter 7
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chap08.html">
   Chapter 8
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chap09.html">
   Chapter 9
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chap10.html">
   Chapter 10
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chap11.html">
   Chapter 11
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chap12.html">
   Chapter 12
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chap13.html">
   Chapter 13
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chap14.html">
   Chapter 14
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chap15.html">
   Chapter 15
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chap16.html">
   Chapter 16
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chap17.html">
   Chapter 17
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chap18.html">
   Chapter 18
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chap19.html">
   Chapter 19
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chap20.html">
   Chapter 20
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chap21.html">
   Chapter 21
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chap22.html">
   Chapter 22
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chap23.html">
   Chapter 23
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chap24.html">
   Chapter 24
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Chapter 25
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chap26.html">
   Chapter 26
  </a>
 </li>
</ul>

</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/chap25.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

        <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/AllenDowney/ModSimPy"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        
        
    </div>
</div>


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/AllenDowney/ModSimPy/master?urlpath=tree/chap25.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#angular-acceleration">
   Angular acceleration
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#moment-of-inertia">
   Moment of inertia
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#teapots-and-turntables">
   Teapots and turntables
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#two-phase-simulation">
   Two Phase Simulation
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#estimating-friction">
   Estimating Friction
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#animation">
   Animation
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#summary">
   Summary
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#exercises">
   Exercises
  </a>
 </li>
</ul>

        </nav>
        
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="chapter-25">
<h1>Chapter 25<a class="headerlink" href="#chapter-25" title="Permalink to this headline">¶</a></h1>
<p><a class="reference external" href="https://colab.research.google.com/github/AllenDowney/ModSimPy/blob/master//chapters/chap25.ipynb">Click here to run this chapter on Colab</a></p>
<p>In the previous chapter we modeled a system with constant angular
velocity.
In this chapter we take the next step, modeling a system with angular acceleration and deceleration.</p>
<div class="section" id="angular-acceleration">
<h2>Angular acceleration<a class="headerlink" href="#angular-acceleration" title="Permalink to this headline">¶</a></h2>
<p>Just as linear acceleration is the derivative of velocity, <strong>angular
acceleration</strong> is the derivative of angular velocity. And just as linear acceleration is caused by force, angular acceleration is caused by the rotational version of force, <strong>torque</strong>. If you are not familiar with torque, you can read about it at <a class="reference external" href="http://modsimpy.com/torque">http://modsimpy.com/torque</a>.</p>
<p>In general, torque is a vector quantity, defined as the <strong>cross
product</strong> of <span class="math notranslate nohighlight">\(\vec{r}\)</span> and <span class="math notranslate nohighlight">\(\vec{F}\)</span>, where <span class="math notranslate nohighlight">\(\vec{r}\)</span> is the <strong>lever
arm</strong>, a vector from the center of rotation to the point where the force is applied, and <span class="math notranslate nohighlight">\(\vec{F}\)</span> is the vector that represents the magnitude and direction of the force.</p>
<p>However, for the problems in this chapter, we only need the <em>magnitude</em> of torque; we don’t care about the direction. In that case, we can compute</p>
<div class="math notranslate nohighlight">
\[\tau = r F \sin \theta\]</div>
<p>where <span class="math notranslate nohighlight">\(\tau\)</span> is torque, <span class="math notranslate nohighlight">\(r\)</span> is the length of the lever arm, <span class="math notranslate nohighlight">\(F\)</span> is the magnitude of force, and <span class="math notranslate nohighlight">\(\theta\)</span> is the angle between <span class="math notranslate nohighlight">\(\vec{r}\)</span> and <span class="math notranslate nohighlight">\(\vec{F}\)</span>.</p>
<p>Since torque is the product of a length and a force, it is expressed in newton meters (Nm).</p>
</div>
<div class="section" id="moment-of-inertia">
<h2>Moment of inertia<a class="headerlink" href="#moment-of-inertia" title="Permalink to this headline">¶</a></h2>
<p>In the same way that linear acceleration is related to force by Newton’s second law of motion, <span class="math notranslate nohighlight">\(F=ma\)</span>, angular acceleration is related to torque by another form of Newton’s law:</p>
<div class="math notranslate nohighlight">
\[\tau = I \alpha\]</div>
<p>where <span class="math notranslate nohighlight">\(\alpha\)</span> is angular acceleration and <span class="math notranslate nohighlight">\(I\)</span> is <strong>moment of inertia</strong>. Just as mass is what makes it hard to accelerate an object, moment of inertia is what makes it hard to spin an object.</p>
<p>In the most general case, a 3-D object rotating around an arbitrary
axis, moment of inertia is a tensor, which is a function that takes a
vector as a parameter and returns a vector as a result.</p>
<p>Fortunately, in a system where all rotation and torque happens around a single axis, we don’t have to deal with the most general case. We can treat moment of inertia as a scalar quantity.</p>
<p>For a small object with mass <span class="math notranslate nohighlight">\(m\)</span>, rotating around a point at distance
<span class="math notranslate nohighlight">\(r\)</span>, the moment of inertia is <span class="math notranslate nohighlight">\(I = m r^2\)</span>. For more complex objects, we can compute <span class="math notranslate nohighlight">\(I\)</span> by dividing the object into small masses, computing
moments of inertia for each mass, and adding them up.</p>
<p>However, for most simple shapes, people have already done the
calculations; you can just look up the answers. For example, see
<a class="reference external" href="http://modsimpy.com/moment">http://modsimpy.com/moment</a>.</p>
</div>
<div class="section" id="teapots-and-turntables">
<h2>Teapots and turntables<a class="headerlink" href="#teapots-and-turntables" title="Permalink to this headline">¶</a></h2>
<p>Tables in Chinese restaurants often have a rotating tray or turntable
that makes it easy for customers to share dishes. These turntables are
supported by low-friction bearings that allow them to turn easily and
glide. However, they can be heavy, especially when they are loaded with food, so they have a high moment of inertia.</p>
<p>Suppose I am sitting at a table with a pot of tea on the turntable
directly in front of me, and the person sitting directly opposite asks
me to pass the tea. I push on the edge of the turntable with 2 N of
force until it has turned 0.5 rad, then let go. The turntable glides
until it comes to a stop 1.5 rad from the starting position. How much
force should I apply for a second push so the teapot glides to a stop
directly opposite me?</p>
<p>We’ll answer this question in these steps:</p>
<ol class="simple">
<li><p>I’ll use the results from the first push to estimate the coefficient of friction for the turntable.</p></li>
<li><p>As an exercise, you’ll use that coefficient of friction to estimate the force needed to rotate the turntable through the remaining angle.</p></li>
</ol>
<p>Our simulation will use the following parameters:</p>
<ol class="simple">
<li><p>The radius of the turntable is 0.5 m, and its weight is 7 kg.</p></li>
<li><p>The teapot weights 0.3 kg, and it sits 0.4 m from the center of the turntable.</p></li>
</ol>
<p>The following figure shows the scenario, where <span class="math notranslate nohighlight">\(F\)</span> is the force I apply to the turntable at the perimeter, perpendicular to the lever arm, <span class="math notranslate nohighlight">\(r\)</span>, and <span class="math notranslate nohighlight">\(\tau\)</span> is the resulting torque. The blue circle near the bottom is the teapot.</p>
<p><img alt="Diagram of a turntable with ateapot." src="https://github.com/AllenDowney/ModSim/raw/main/figs/teapot.png" /></p>
<p>Here are the parameters from the statement of the problem:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">pi</span>

<span class="n">radius_disk</span> <span class="o">=</span> <span class="mf">0.5</span>     <span class="c1"># m</span>
<span class="n">mass_disk</span> <span class="o">=</span> <span class="mi">7</span>         <span class="c1"># kg</span>
<span class="n">radius_pot</span> <span class="o">=</span> <span class="mf">0.4</span>      <span class="c1"># m</span>
<span class="n">mass_pot</span> <span class="o">=</span> <span class="mf">0.3</span>        <span class="c1"># kg</span>
<span class="n">force</span> <span class="o">=</span> <span class="mi">2</span>             <span class="c1"># N</span>

<span class="n">theta_push</span> <span class="o">=</span> <span class="mf">0.5</span>        <span class="c1"># radian</span>
<span class="n">theta_test</span> <span class="o">=</span> <span class="mf">1.5</span>        <span class="c1"># radian</span>
<span class="n">theta_target</span> <span class="o">=</span> <span class="n">pi</span>       <span class="c1"># radian</span>
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">theta_push</span></code> is the angle where I stop pushing on the turntable.
<code class="docutils literal notranslate"><span class="pre">theta_test</span></code> is how far the table turns during my test push.
<code class="docutils literal notranslate"><span class="pre">theta_target</span></code> is where we want the table to be after the second push.</p>
<p>We can use these parameters to compute the moment of inertia of the turntable, using the formula for a horizontal disk revolving around a vertical axis through its center:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">I_disk</span> <span class="o">=</span> <span class="n">mass_disk</span> <span class="o">*</span> <span class="n">radius_disk</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="mi">2</span>
</pre></div>
</div>
</div>
</div>
<p>We can also compute the moment of inertia of the teapot, treating it as a point mass:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">I_pot</span> <span class="o">=</span> <span class="n">mass_pot</span> <span class="o">*</span> <span class="n">radius_pot</span><span class="o">**</span><span class="mi">2</span>
</pre></div>
</div>
</div>
</div>
<p>The total moment of inertia is the sum of these parts:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">I_total</span> <span class="o">=</span> <span class="n">I_disk</span> <span class="o">+</span> <span class="n">I_pot</span>
</pre></div>
</div>
</div>
</div>
<p>Friction in the bearings probably depends on the weight of the turntable and its contents, but probably does not depend on angular velocity.
So we’ll assume that it is a constant.
We don’t know what it is, so I will start with a guess, and we will use <code class="docutils literal notranslate"><span class="pre">root_scalar</span></code> to improve it.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">torque_friction</span> <span class="o">=</span> <span class="mf">0.3</span>   <span class="c1"># N*m</span>
</pre></div>
</div>
</div>
</div>
<p>For this problem we’ll treat friction as a torque.</p>
<p>The state variables we’ll use are <code class="docutils literal notranslate"><span class="pre">theta</span></code>, which is the angle of the table in rad, and <code class="docutils literal notranslate"><span class="pre">omega</span></code>, which is angular velocity in rad/s.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">init</span> <span class="o">=</span> <span class="n">State</span><span class="p">(</span><span class="n">theta</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">omega</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Now we can make a <code class="docutils literal notranslate"><span class="pre">System</span></code> with the initial state, <code class="docutils literal notranslate"><span class="pre">init</span></code>, the maximum duration of the simulation, <code class="docutils literal notranslate"><span class="pre">t_end</span></code>, and the parameters we are going to vary, <code class="docutils literal notranslate"><span class="pre">force</span></code> and <code class="docutils literal notranslate"><span class="pre">torque_friction</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">system</span> <span class="o">=</span> <span class="n">System</span><span class="p">(</span><span class="n">init</span><span class="o">=</span><span class="n">init</span><span class="p">,</span> 
                <span class="n">force</span><span class="o">=</span><span class="n">force</span><span class="p">,</span>
                <span class="n">torque_friction</span><span class="o">=</span><span class="n">torque_friction</span><span class="p">,</span>
                <span class="n">t_end</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Here’s a slope function that takes the current state, which contains angle and angular velocity, and returns the derivatives, angular velocity and angular acceleration:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">slope_func</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">state</span><span class="p">,</span> <span class="n">system</span><span class="p">):</span>
    <span class="n">theta</span><span class="p">,</span> <span class="n">omega</span> <span class="o">=</span> <span class="n">state</span>
    <span class="n">force</span> <span class="o">=</span> <span class="n">system</span><span class="o">.</span><span class="n">force</span>
    <span class="n">torque_friction</span> <span class="o">=</span> <span class="n">system</span><span class="o">.</span><span class="n">torque_friction</span>
    
    <span class="n">torque</span> <span class="o">=</span> <span class="n">radius_disk</span> <span class="o">*</span> <span class="n">force</span> <span class="o">-</span> <span class="n">torque_friction</span>
    <span class="n">alpha</span> <span class="o">=</span> <span class="n">torque</span> <span class="o">/</span> <span class="n">I_total</span>
    
    <span class="k">return</span> <span class="n">omega</span><span class="p">,</span> <span class="n">alpha</span> 
</pre></div>
</div>
</div>
</div>
<p>In this scenario, the force I apply to the turntable is always
perpendicular to the lever arm, so <span class="math notranslate nohighlight">\(\sin \theta = 1\)</span> and the torque due
to force is <span class="math notranslate nohighlight">\(\tau = r F\)</span>.</p>
<p><code class="docutils literal notranslate"><span class="pre">torque_friction</span></code> represents the torque due to friction. Because the
turntable is rotating in the direction of positive <code class="docutils literal notranslate"><span class="pre">theta</span></code>, friction
acts in the direction of negative <code class="docutils literal notranslate"><span class="pre">theta</span></code>.</p>
<p>We can test the slope function with the initial conditions:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">slope_func</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">system</span><span class="o">.</span><span class="n">init</span><span class="p">,</span> <span class="n">system</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(0, 0.7583965330444203)
</pre></div>
</div>
</div>
</div>
<p>We are almost ready to run the simulation, but first there’s a problem we have to address.</p>
</div>
<div class="section" id="two-phase-simulation">
<h2>Two Phase Simulation<a class="headerlink" href="#two-phase-simulation" title="Permalink to this headline">¶</a></h2>
<p>When I stop pushing on the turntable, the angular acceleration changes
abruptly. We could implement the slope function with an <code class="docutils literal notranslate"><span class="pre">if</span></code> statement
that checks the value of <code class="docutils literal notranslate"><span class="pre">theta</span></code> and sets <code class="docutils literal notranslate"><span class="pre">force</span></code> accordingly. And for a coarse model like this one, that might be fine. But a more robust approach is to simulate the system in two phases:</p>
<ol class="simple">
<li><p>During the first phase, force is constant, and we run until <code class="docutils literal notranslate"><span class="pre">theta</span></code> is 0.5 radians.</p></li>
<li><p>During the second phase, force is 0, and we run until <code class="docutils literal notranslate"><span class="pre">omega</span></code> is 0.</p></li>
</ol>
<p>Then we can combine the results of the two phases into a single
<code class="docutils literal notranslate"><span class="pre">TimeFrame</span></code>.</p>
<p>Here’s the event function I’ll use for Phase 1; it stops the simulation when <code class="docutils literal notranslate"><span class="pre">theta</span></code> reaches <code class="docutils literal notranslate"><span class="pre">theta_push</span></code>, which is when I stop pushing:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">event_func1</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">state</span><span class="p">,</span> <span class="n">system</span><span class="p">):</span>
    <span class="n">theta</span><span class="p">,</span> <span class="n">omega</span> <span class="o">=</span> <span class="n">state</span>
    <span class="k">return</span> <span class="n">theta</span> <span class="o">-</span> <span class="n">theta_push</span>
</pre></div>
</div>
</div>
</div>
<p>We can test it with the initial conditions.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">event_func1</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">system</span><span class="o">.</span><span class="n">init</span><span class="p">,</span> <span class="n">system</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-0.5
</pre></div>
</div>
</div>
</div>
<p>And run the first phase of the simulation.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">results1</span><span class="p">,</span> <span class="n">details1</span> <span class="o">=</span> <span class="n">run_solve_ivp</span><span class="p">(</span><span class="n">system</span><span class="p">,</span> <span class="n">slope_func</span><span class="p">,</span>
                                   <span class="n">events</span><span class="o">=</span><span class="n">event_func1</span><span class="p">)</span>
<span class="n">details1</span><span class="o">.</span><span class="n">message</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;A termination event occurred.&#39;
</pre></div>
</div>
</div>
</div>
<p>Here are the last few time steps.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">results1</span><span class="o">.</span><span class="n">tail</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>theta</th>
      <th>omega</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1.102359</th>
      <td>0.46080</td>
      <td>0.836025</td>
    </tr>
    <tr>
      <th>1.113842</th>
      <td>0.47045</td>
      <td>0.844734</td>
    </tr>
    <tr>
      <th>1.125325</th>
      <td>0.48020</td>
      <td>0.853442</td>
    </tr>
    <tr>
      <th>1.136808</th>
      <td>0.49005</td>
      <td>0.862151</td>
    </tr>
    <tr>
      <th>1.148291</th>
      <td>0.50000</td>
      <td>0.870860</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>It takes a little more than a second for me to rotate the table 0.5 rad.
When I release the table, the angular velocity is about 0.87 rad / s.</p>
<p>Before we run the second phase, we have to extract the final time and
state of the first phase.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t_2</span> <span class="o">=</span> <span class="n">results1</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">init2</span> <span class="o">=</span> <span class="n">results1</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>Now we can make a <code class="docutils literal notranslate"><span class="pre">System</span></code> object for Phase 2 with the initial state
from Phase 1 and with <code class="docutils literal notranslate"><span class="pre">force=0</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">system2</span> <span class="o">=</span> <span class="n">system</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">t_0</span><span class="o">=</span><span class="n">t_2</span><span class="p">,</span> <span class="n">init</span><span class="o">=</span><span class="n">init2</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>For the second phase, we need an event function that stops when the
turntable stops; that is, when angular velocity is 0.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">event_func2</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">state</span><span class="p">,</span> <span class="n">system</span><span class="p">):</span>
    <span class="n">theta</span><span class="p">,</span> <span class="n">omega</span> <span class="o">=</span> <span class="n">state</span>
    <span class="k">return</span> <span class="n">omega</span>
</pre></div>
</div>
</div>
</div>
<p>We’ll test it with the initial conditions for Phase 2.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">event_func2</span><span class="p">(</span><span class="n">system2</span><span class="o">.</span><span class="n">t_0</span><span class="p">,</span> <span class="n">system2</span><span class="o">.</span><span class="n">init</span><span class="p">,</span> <span class="n">system2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.8708596517490182
</pre></div>
</div>
</div>
</div>
<p>Now we can run the second phase.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">results2</span><span class="p">,</span> <span class="n">details2</span> <span class="o">=</span> <span class="n">run_solve_ivp</span><span class="p">(</span><span class="n">system2</span><span class="p">,</span> <span class="n">slope_func</span><span class="p">,</span>
                                   <span class="n">events</span><span class="o">=</span><span class="n">event_func2</span><span class="p">)</span>
<span class="n">details2</span><span class="o">.</span><span class="n">message</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;A termination event occurred.&#39;
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> provides <code class="docutils literal notranslate"><span class="pre">append</span></code>, which appends <code class="docutils literal notranslate"><span class="pre">results2</span></code> to the end of
<code class="docutils literal notranslate"><span class="pre">results1</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="n">results1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">results2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Here are the last few time steps.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">results</span><span class="o">.</span><span class="n">tail</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>theta</th>
      <th>omega</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>3.720462</th>
      <td>1.664800</td>
      <td>3.483439e-02</td>
    </tr>
    <tr>
      <th>3.747255</th>
      <td>1.665617</td>
      <td>2.612579e-02</td>
    </tr>
    <tr>
      <th>3.774049</th>
      <td>1.666200</td>
      <td>1.741719e-02</td>
    </tr>
    <tr>
      <th>3.800842</th>
      <td>1.666550</td>
      <td>8.708597e-03</td>
    </tr>
    <tr>
      <th>3.827636</th>
      <td>1.666667</td>
      <td>-2.220446e-16</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>At the end, angular velocity is close to 0, and the total rotation is about 1.7 rad, a little farther than we were aiming for.</p>
<p>We can plot <code class="docutils literal notranslate"><span class="pre">theta</span></code> for both phases.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">results</span><span class="o">.</span><span class="n">theta</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;theta&#39;</span><span class="p">)</span>
<span class="n">decorate</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Time (s)&#39;</span><span class="p">,</span>
             <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Angle (rad)&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/chap25_51_0.png" src="_images/chap25_51_0.png" />
</div>
</div>
<p>And <code class="docutils literal notranslate"><span class="pre">omega</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">results</span><span class="o">.</span><span class="n">omega</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;omega&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;C1&#39;</span><span class="p">)</span>
<span class="n">decorate</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Time (s)&#39;</span><span class="p">,</span>
             <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Angular velocity (rad/s)&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/chap25_53_0.png" src="_images/chap25_53_0.png" />
</div>
</div>
<p>Angular velocity, <code class="docutils literal notranslate"><span class="pre">omega</span></code>, increases linearly while I am pushing, and decreases linearly after I let go. The angle, <code class="docutils literal notranslate"><span class="pre">theta</span></code>, is the integral of angular velocity, so it forms a parabola during each phase.</p>
<p>In the next section, we’ll use this simulation to estimate the torque
due to friction.</p>
</div>
<div class="section" id="estimating-friction">
<h2>Estimating Friction<a class="headerlink" href="#estimating-friction" title="Permalink to this headline">¶</a></h2>
<p>Let’s take the code from the previous section and wrap it in a function.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">run_two_phases</span><span class="p">(</span><span class="n">force</span><span class="p">,</span> <span class="n">torque_friction</span><span class="p">,</span> <span class="n">system</span><span class="p">):</span>
    
    <span class="c1"># put the specified parameters into the System object</span>
    <span class="n">system1</span> <span class="o">=</span> <span class="n">system</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">force</span><span class="o">=</span><span class="n">force</span><span class="p">,</span> 
                         <span class="n">torque_friction</span><span class="o">=</span><span class="n">torque_friction</span><span class="p">)</span>

    <span class="c1"># run phase 1</span>
    <span class="n">results1</span><span class="p">,</span> <span class="n">details1</span> <span class="o">=</span> <span class="n">run_solve_ivp</span><span class="p">(</span><span class="n">system1</span><span class="p">,</span> <span class="n">slope_func</span><span class="p">,</span> 
                                       <span class="n">events</span><span class="o">=</span><span class="n">event_func1</span><span class="p">)</span>

    <span class="c1"># get the final state from phase 1</span>
    <span class="n">t_2</span> <span class="o">=</span> <span class="n">results1</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">init2</span> <span class="o">=</span> <span class="n">results1</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    
    <span class="c1"># run phase 2</span>
    <span class="n">system2</span> <span class="o">=</span> <span class="n">system1</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">t_0</span><span class="o">=</span><span class="n">t_2</span><span class="p">,</span> <span class="n">init</span><span class="o">=</span><span class="n">init2</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">results2</span><span class="p">,</span> <span class="n">details2</span> <span class="o">=</span> <span class="n">run_solve_ivp</span><span class="p">(</span><span class="n">system2</span><span class="p">,</span> <span class="n">slope_func</span><span class="p">,</span> 
                                       <span class="n">events</span><span class="o">=</span><span class="n">event_func2</span><span class="p">)</span>
    
    <span class="c1"># combine and return the results</span>
    <span class="n">results</span> <span class="o">=</span> <span class="n">results1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">results2</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">results</span>
</pre></div>
</div>
</div>
</div>
<p>I’ll test it with the same parameters.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">force</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">torque_friction</span> <span class="o">=</span> <span class="mf">0.3</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">run_two_phases</span><span class="p">(</span><span class="n">force</span><span class="p">,</span> <span class="n">torque_friction</span><span class="p">,</span> <span class="n">system</span><span class="p">)</span>
<span class="n">results</span><span class="o">.</span><span class="n">tail</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>theta</th>
      <th>omega</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>3.720462</th>
      <td>1.664800</td>
      <td>3.483439e-02</td>
    </tr>
    <tr>
      <th>3.747255</th>
      <td>1.665617</td>
      <td>2.612579e-02</td>
    </tr>
    <tr>
      <th>3.774049</th>
      <td>1.666200</td>
      <td>1.741719e-02</td>
    </tr>
    <tr>
      <th>3.800842</th>
      <td>1.666550</td>
      <td>8.708597e-03</td>
    </tr>
    <tr>
      <th>3.827636</th>
      <td>1.666667</td>
      <td>-2.220446e-16</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>These results are the same as in the previous section.</p>
<p>We can use <code class="docutils literal notranslate"><span class="pre">run_two_phases</span></code> to write an error function we can use, with <code class="docutils literal notranslate"><span class="pre">root_scalar</span></code>, to find the torque due to friction that yields the
observed results from the first push, a total rotation of 1.5 rad.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">error_func1</span><span class="p">(</span><span class="n">torque_friction</span><span class="p">,</span> <span class="n">system</span><span class="p">):</span>
    <span class="n">force</span> <span class="o">=</span> <span class="n">system</span><span class="o">.</span><span class="n">force</span>
    <span class="n">results</span> <span class="o">=</span> <span class="n">run_two_phases</span><span class="p">(</span><span class="n">force</span><span class="p">,</span> <span class="n">torque_friction</span><span class="p">,</span> <span class="n">system</span><span class="p">)</span>
    <span class="n">theta_final</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">theta</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">torque_friction</span><span class="p">,</span> <span class="n">theta_final</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">theta_final</span> <span class="o">-</span> <span class="n">theta_test</span>
</pre></div>
</div>
</div>
</div>
<p>With <code class="docutils literal notranslate"><span class="pre">torque_friction=0.3</span></code>, the table rotates a bit too far:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">guess1</span> <span class="o">=</span> <span class="mf">0.3</span>
<span class="n">error_func1</span><span class="p">(</span><span class="n">guess1</span><span class="p">,</span> <span class="n">system</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.3 1.666666666666669
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.16666666666666896
</pre></div>
</div>
</div>
</div>
<p>With <code class="docutils literal notranslate"><span class="pre">torque_friction=0.4</span></code>, it doesn’t go far enough.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">guess2</span> <span class="o">=</span> <span class="mf">0.4</span>
<span class="n">error_func1</span><span class="p">(</span><span class="n">guess2</span><span class="p">,</span> <span class="n">system</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.4 1.2499999999999996
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-0.25000000000000044
</pre></div>
</div>
</div>
</div>
<p>So we can use those two values as a bracket for <code class="docutils literal notranslate"><span class="pre">root_scalar</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">res</span> <span class="o">=</span> <span class="n">root_scalar</span><span class="p">(</span><span class="n">error_func1</span><span class="p">,</span> <span class="n">system</span><span class="p">,</span> <span class="n">bracket</span><span class="o">=</span><span class="p">[</span><span class="n">guess1</span><span class="p">,</span> <span class="n">guess2</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.3 1.666666666666669
0.3 1.666666666666669
0.4 1.2499999999999996
0.3400000000000003 1.4705882352941169
0.3340000000000002 1.4970059880239517
0.3333320000000001 1.5000060000239976
0.3333486666010001 1.4999310034693254
</pre></div>
</div>
</div>
</div>
<p>The result is 0.333 N m, a little less than the initial guess.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">actual_friction</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">root</span>
<span class="n">actual_friction</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.3333320000000001
</pre></div>
</div>
</div>
</div>
<p>Now that we know the torque due to friction, we can compute the force
needed to rotate the turntable through the remaining angle, that is,
from 1.5 rad to 3.14 rad.</p>
<p>But first, let’s animate the results.</p>
</div>
<div class="section" id="animation">
<h2>Animation<a class="headerlink" href="#animation" title="Permalink to this headline">¶</a></h2>
<p>Here’s a function that takes the state of the system and draws it.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">matplotlib.patches</span> <span class="kn">import</span> <span class="n">Circle</span>
<span class="kn">from</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">import</span> <span class="n">gca</span><span class="p">,</span> <span class="n">axis</span>

<span class="k">def</span> <span class="nf">draw_func</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">state</span><span class="p">):</span>
    <span class="n">theta</span><span class="p">,</span> <span class="n">omega</span> <span class="o">=</span> <span class="n">state</span>
    
    <span class="c1"># draw a circle for the table</span>
    <span class="n">circle1</span> <span class="o">=</span> <span class="n">Circle</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">radius_disk</span><span class="p">)</span>
    <span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">circle1</span><span class="p">)</span>
    
    <span class="c1"># draw a circle for the teapot</span>
    <span class="n">center</span> <span class="o">=</span> <span class="n">pol2cart</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">radius_pot</span><span class="p">)</span>
    <span class="n">circle2</span> <span class="o">=</span> <span class="n">Circle</span><span class="p">(</span><span class="n">center</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;C1&#39;</span><span class="p">)</span>
    <span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">circle2</span><span class="p">)</span>

    <span class="n">axis</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>This function uses a few features we have not seen before, but you can read about them in the Matplotlib documentation.</p>
<p>Here’s what the initial condition looks like.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">state</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">draw_func</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">state</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/chap25_73_0.png" src="_images/chap25_73_0.png" />
</div>
</div>
<p>And here’s an animation of the first push.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># animate(results, draw_func)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="summary">
<h2>Summary<a class="headerlink" href="#summary" title="Permalink to this headline">¶</a></h2>
<p>The example in this chapter demonstrates the concepts of torque, angular acceleration, and moment of inertia.
We used these concepts to simulate a turntable, using a hypothetical observation to estimating torque due to friction.
As an exercise, you can finish off the example, estimating the force needed to rotate the table to a given target angle.</p>
<p>The next chapter describes several case studies you can work on to practice the tools from the last few chapters, including projectiles, rotating objects, <code class="docutils literal notranslate"><span class="pre">root_scalar</span></code>, and <code class="docutils literal notranslate"><span class="pre">maximize_scalar</span></code>.</p>
</div>
<div class="section" id="exercises">
<h2>Exercises<a class="headerlink" href="#exercises" title="Permalink to this headline">¶</a></h2>
<p><strong>Exercise:</strong> Continuing the example from this chapter, estimate the force that delivers the teapot to the desired position.
Use this <code class="docutils literal notranslate"><span class="pre">System</span></code> object, with the friction we computed in the previous section.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">system3</span> <span class="o">=</span> <span class="n">system</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">torque_friction</span><span class="o">=</span><span class="n">actual_friction</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Write an error function that takes <code class="docutils literal notranslate"><span class="pre">force</span></code> and <code class="docutils literal notranslate"><span class="pre">system</span></code>, simulates the system, and returns the difference between <code class="docutils literal notranslate"><span class="pre">theta_final</span></code> and the remaining angle after the first push.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">remaining_angle</span> <span class="o">=</span> <span class="n">theta_target</span> <span class="o">-</span> <span class="n">theta_test</span>
<span class="n">remaining_angle</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1.6415926535897931
</pre></div>
</div>
</div>
</div>
<p>Use your error function and <code class="docutils literal notranslate"><span class="pre">root_scalar</span></code> to find the force needed for the second push.
Run the simulation with the force you computed and confirm that the table stops at the target angle after both pushes.</p>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Solution</span>

<span class="k">def</span> <span class="nf">error_func2</span><span class="p">(</span><span class="n">force</span><span class="p">,</span> <span class="n">system</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Error function for root_scalar.</span>
<span class="sd">    </span>
<span class="sd">    force: hypothetical value</span>
<span class="sd">    </span>
<span class="sd">    returns: offset from target value</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">results</span> <span class="o">=</span> <span class="n">run_two_phases</span><span class="p">(</span><span class="n">force</span><span class="p">,</span> <span class="n">system</span><span class="o">.</span><span class="n">torque_friction</span><span class="p">,</span> <span class="n">system</span><span class="p">)</span>
    <span class="n">theta_final</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">theta</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">force</span><span class="p">,</span> <span class="n">theta_final</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">theta_final</span> <span class="o">-</span> <span class="n">remaining_angle</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Solution</span>

<span class="n">guess1</span> <span class="o">=</span> <span class="mf">2.0</span>
<span class="n">error_func2</span><span class="p">(</span><span class="n">guess1</span><span class="p">,</span> <span class="n">system3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2.0 1.5000060000239976
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-0.14158665356579547
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Solution</span>

<span class="n">guess2</span> <span class="o">=</span> <span class="mf">3.0</span>
<span class="n">error_func2</span><span class="p">(</span><span class="n">guess2</span><span class="p">,</span> <span class="n">system3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3.0 2.250009000035999
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.608416346446206
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Solution</span>

<span class="n">res</span> <span class="o">=</span> <span class="n">root_scalar</span><span class="p">(</span><span class="n">error_func2</span><span class="p">,</span> <span class="n">system3</span><span class="p">,</span> <span class="n">bracket</span><span class="o">=</span><span class="p">[</span><span class="n">guess1</span><span class="p">,</span> <span class="n">guess2</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2.0 1.5000060000239976
2.0 1.5000060000239976
3.0 2.250009000035999
2.1887814496255746 1.641592653589789
2.188890888699056 1.6416747332232227
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Solution</span>

<span class="n">force</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">root</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">run_two_phases</span><span class="p">(</span><span class="n">force</span><span class="p">,</span> <span class="n">actual_friction</span><span class="p">,</span> <span class="n">system3</span><span class="p">)</span>
<span class="n">theta_final</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">theta</span>
<span class="n">theta_final</span> <span class="o">+</span> <span class="n">theta_test</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3.1415926535897887
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Solution</span>

<span class="n">theta_target</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3.141592653589793
</pre></div>
</div>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="chap24.html" title="previous page">Chapter 24</a>
    <a class='right-next' id="next-link" href="chap26.html" title="next page">Chapter 26</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Allen B. Downey<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="_static/js/index.d3f166471bb80abb5163.js"></script>


    
  </body>
</html>